---
layout:     post
title:      孵蛋机
subtitle:   说不定哪颗蛋就从这里出去，成为独当一面的文章呢
date:       2020-8-4
author:     Elias
header-img: img/post-bg-HaiGui.jpg
catalog: true
tags:

    - Blog
---

# 孵蛋机

## 前言

无数不成体系的养料都在这里，等待成为一个蛋，等待被孵化。

### GDI绘图（C#）

​	C#中使用GDI绘图，需要`using System.Drawing;`

1. #### GDI简单绘图

   想要绘制图形，首先需要有承载图形的画板和用于绘图的画笔。

   ```c#
   //创建GDI对象
   Graphics graphics = this.CreateGraphics();
   //创建画笔对象
   Pen pen = new Pen(Brushes.Red);
   ```

   绘制直线

   ```C#
   //创建两个点
   Point p1 = new Point(30, 50);
   Point p2 = new Point(100, 100);
   //绘制线
   graphics.DrawLine(pen,p1,p2);
   ```

   绘制矩形

   ```c#
   Size size = new Size(140, 50);
   Rectangle rec = new Rectangle(new Point(130, 50), size);
   graphics.DrawRectangle(pen, rec);
   ```

   绘制扇形

   ```c#
   Size size = new Size(140, 140);
   Rectangle rec = new Rectangle(new Point(280, 0), size);
   graphics.DrawPie(pen,rec,60,60);
   ```

   绘制字符串

   ```C#
   graphics.DrawString(
   	"要绘制的字符串",
   	new Font("宋体",20,FontStyle.Bold),
   	Brushes.Black,
   	new Point(430,50));
   ```

   绘制指定图片

   ```C#
   graphics.DrawImage(
       Image.FromFile(@"这是图片路径"),
   	x,
   	y,
   	width,
   	height);
   ```

2. #### GDI绘图时消除闪烁现象（使用双缓冲）

   当所需绘制的图形过多且希望部分图片移动时，界面往往由于不断对图形进行绘制，且由于所有待绘制图形不能同时绘制，因此会出现部分图形先出现，部分图形后出现的现象，再加上刷新频率较快，因此导致闪烁。

   消除闪烁的方法很简单，只需我们将图形全部先绘制在虚拟画布上（而不是直接绘制在窗体上），在一次绘制完成后，再将该画布内容一次性画到窗体上，就能够避免闪烁现象。这一方法也叫做**双缓冲技术**。

   为了实现这一技术，我们首先需要在相应窗体的InitializeComponent()中加入：

   ```C#
   this.DoubleBuffered = true;//双缓冲
   ```

   以此开启开窗体的双缓冲。

   接着需要创建一张虚拟画布，并将所有待绘制图形全部绘制到该虚拟画布上：

   ```C#
   //建立虚拟画布
   Bitmap bitp = new Bitmap(this.Width, this.Height);
   //将所有绘图操作绑定在虚拟画布上
   Graphics g = Graphics.FromImage(bitp);
   //开始绘图
   ......
   //所有待绘制图形绘制完毕后，将虚拟画布上的内容绘制到窗体
   this.CreateGraphics().DrawImage(bitp, 0, 0);
   //单次绘图完毕后释放绘制资源
   g.Dispose();
   //释放虚拟画布资源
   bitp.Dispose();
   ```

   至此，就通过使用双缓冲解决了GDI窗体绘图闪烁问题。

   至于窗体内控件使用过多导致窗体闪烁的问题，将通过另一方式实现，即在窗体的InitializeComponent()中加入一些代码，这里不再细说，有需要可以网上搜搜（绝对~~不~~是因为我太懒才不写的！）